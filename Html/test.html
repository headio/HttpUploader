<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>plugin test</title>
    <object id="Uploader" classid="clsid:3F31A1AB-6A27-4459-B9D8-C8C459F1F30D"></object>
    <script type="text/javascript">
      function AppendOutput(txt) {
        var e = document.getElementById("output");
        e.value = e.value + "\n" + txt;
      }
      function ShowDialog() {
        Uploader.ShowDialog();
        var selected = Uploader.GetSelectedFiles();
        for (var i = 0; i < selected.Size(); ++i) {
          AppendOutput(selected.At(i));
        }
      }
      function ClearOutput() {
        var e = document.getElementById("output");
        e.value = ""
      }
      function Md5Getted(file, md5) {
        AppendOutput("file name: " + file);
        AppendOutput("md5: " + md5);
      }
      function Test() {
        
      }
      function OnPostFile(id, speed, posted, percent, lefttime) {
        AppendOutput("OnPost id:" + id + " speed:" + speed + " posted:"
            + posted + " percent:" + percent + " lefttime:" + lefttime);
      }
      function CalcAllFileMd5() {
        var selected = Uploader.GetSelectedFiles();
        for (var i = 0; i < selected.Size(); ++i) {
          var file = selected.At(i);
          AsyncCalcMd5(file);
        }
      }
      function AsyncCalcMd5(file) {
        return Uploader.AsyncCalcMd5(file, Md5Getted);
      }
    </script>
  </head>
  
  <body>
    <button OnClick="javascript:ShowDialog()" style="top:0;">ShowDialog</button>
    <button OnClick="javascript:CalcAllFileMd5()">Calc All</button>
    <button OnClick="javascript:ClearOutput()" style="">ClearOutput</button>
    <button OnClick="javascript:Test()">Test</button>
    <p />
    <textarea id="output" style="margin-top:20px;width:80%;height:300px;"></textarea>
  </body>
</html>